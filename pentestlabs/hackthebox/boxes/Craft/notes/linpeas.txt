linpeas v2.2.5 by carlospolop

Linux Privesc Checklist: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist
 LEYEND:
  RED/YELLOW: 99% a PE vector
  RED: You must take a look at it
  LightCyan: Users with console
  Blue: Users without console & mounted devs
  Green: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs)
  LightMangenta: Your username

  YOU ARE ALREADY ROOT!!! (it could take longer to complete execution)



IMPORTANT CHANGE: For satisfying most users and thanks to the incorporation of the 2000pwds/user su bruteforce, the default behaviour of linpeas has been changed to fast/stealth (no writting to disk, no 1min processes check, and no su BF). Use the parameter -a to execute all these checks.

====================================( Basic information )=====================================
OS: Linux version 4.9.0-8-amd64 (debian-kernel@lists.debian.org) (gcc version 6.3.0 20170516 (Debian 6.3.0-18+deb9u1) ) #1 SMP Debian 4.9.130-2 (2018-10-27)
User & Groups: uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
Hostname: 5a3d243127f5
Writable folder: /bin
[+] /bin/ping is available for network discovery (You can use linpeas to discover hosts, learn more with -h)
[+] /usr/bin/nc is available for network discover & port scanning (You can use linpeas to discover hosts/port scanning, learn more with -h)


====================================( System Information )====================================
[+] Operative system
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#kernel-exploits
Linux version 4.9.0-8-amd64 (debian-kernel@lists.debian.org) (gcc version 6.3.0 20170516 (Debian 6.3.0-18+deb9u1) ) #1 SMP Debian 4.9.130-2 (2018-10-27)

[+] Sudo version
sudo Not Found

[+] PATH
[i] Any writable folder in original PATH? (a new completed path will be exported)
/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
New path exported: /usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin

[+] Date
Thu Dec 19 22:39:12 UTC 2019

[+] System stats
Filesystem                Size      Used Available Use% Mounted on
overlay                  10.8G      3.5G      6.7G  35% /
tmpfs                    64.0M         0     64.0M   0% /dev
tmpfs                  1002.2M         0   1002.2M   0% /sys/fs/cgroup
/dev/sda1                10.8G      3.5G      6.7G  35% /opt/app
/dev/sda1                10.8G      3.5G      6.7G  35% /etc/resolv.conf
/dev/sda1                10.8G      3.5G      6.7G  35% /etc/hostname
/dev/sda1                10.8G      3.5G      6.7G  35% /etc/hosts
shm                      64.0M    180.0K     63.8M   0% /dev/shm
tmpfs                  1002.2M         0   1002.2M   0% /proc/acpi
tmpfs                    64.0M         0     64.0M   0% /proc/kcore
tmpfs                    64.0M         0     64.0M   0% /proc/keys
tmpfs                    64.0M         0     64.0M   0% /proc/timer_list
tmpfs                    64.0M         0     64.0M   0% /proc/sched_debug
tmpfs                  1002.2M         0   1002.2M   0% /sys/firmware
             total       used       free     shared    buffers     cached
Mem:       2052420    1860432     191988       6296      34108     890712
-/+ buffers/cache:     935612    1116808
Swap:      1046524        108    1046416

[+] Environment
[i] Any private information inside environment variables?
HISTFILESIZE=0
HOSTNAME=5a3d243127f5
PYTHON_PIP_VERSION=19.0.1
SHLVL=4
HOME=/home/root
GPG_KEY=0D96DF4D4110E5C43FBFB17F2D347EA6AA65421D
PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
LANG=C.UTF-8
HISTSIZE=0
PYTHON_VERSION=3.6.8
HISTFILE=/dev/null

[+] Looking for Signature verification failed in dmseg
 Not Found

[+] selinux enabled? .......... sestatus Not Found
[+] Printer? .......... lpstat Not Found
[+] Is this a container? .......... Looks like we're in a Docker container
[+] Is ASLR enabled? .......... Yes

=========================================( Devices )==========================================
[+] Any sd* disk in /dev? (limit 20)

[+] Unmounted file-system?
[i] Check if you can mount umounted devices
/dev/cdrom      /media/cdrom    iso9660 noauto,ro 0 0
/dev/usbdisk    /media/usb      vfat    noauto,ro 0 0


====================================( Available Software )====================================
[+] Useful software?
/usr/bin/nc
/usr/bin/wget
/bin/ping
/usr/bin/gcc
/bin/base64
/usr/local/bin/python
/usr/local/bin/python3
/usr/local/bin/python3.6

[+] Installed compilers?
/usr/bin/gcc
Compilers Not Found


================================( Processes, Cron & Services )================================
[+] Cleaned processes
[i] Check weird & unexpected proceses run by root: https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes
PID   USER     TIME  COMMAND
    1 root      0:03 python ./app.py
   38 root      0:04 /tmp/shell
   79 root      0:00 /bin/sh
   82 root      0:00 python -c import pty; pty.spawn("/bin/sh")
   83 root      0:00 /bin/sh
  665 root      0:00 /bin/sh
  803 root      0:00 ping 10.10.14.179
 1542 root      0:00 sh ./LinEnum.sh
 1543 root      0:00 sh ./LinEnum.sh
 1544 root      0:00 tee -a
 1681 root      0:00 sh ./linpeas.sh
 1857 root      0:00 sh ./LinEnum.sh
 1858 root      0:01 find / -perm -4000 -type f -exec ls -la {} ;
 1859 root      0:00 grep -w aria2c\|arp\|ash\|awk\|base64\|bash\|busybox\|cat\|chmod\|chown\|cp\|csh\|curl\|cut\|dash\|date\|dd\|diff\|dmsetup\|docker\|ed\|emacs\|env\|expand\|expect\|file\|find\|flock\|fmt\|fold\|ftp\|gawk\|gdb\|gimp\|git\|grep\|head\|ht\|iftop\|ionice\|ip$\|irb\|jjs\|jq\|jrunscript\|ksh\|ld.so\|ldconfig\|less\|logsave\|lua\|make\|man\|mawk\|more\|mv\|mysql\|nano\|nawk\|nc\|netcat\|nice\|nl\|nmap\|node\|od\|openssl\|perl\|pg\|php\|pic\|pico\|python\|readelf\|rlwrap\|rpm\|rpmquery\|rsync\|ruby\|run-parts\|rvim\|scp\|script\|sed\|setarch\|sftp\|sh\|shuf\|socat\|sort\|sqlite3\|ssh$\|start-stop-daemon\|stdbuf\|strace\|systemctl\|tail\|tar\|taskset\|tclsh\|tee\|telnet\|tftp\|time\|timeout\|ul\|unexpand\|uniq\|unshare\|vi\|vim\|watch\|wget\|wish\|xargs\|xxd\|zip\|zsh
 1954 root      0:00 ps aux

[+] Binary processes permissions
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes

[+] Cron jobs
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#scheduled-jobs
# do daily/weekly/monthly maintenance
# min   hour    day     month   weekday command
*/15    *       *       *       *       run-parts /etc/periodic/15min
0       *       *       *       *       run-parts /etc/periodic/hourly
0       2       *       *       *       run-parts /etc/periodic/daily
0       3       *       *       6       run-parts /etc/periodic/weekly
0       5       1       *       *       run-parts /etc/periodic/monthly

total 12
drwxr-xr-x    2 root     root          4096 Jan 30  2019 .
drwxr-xr-x    1 root     root          4096 Feb 10  2019 ..
-rw-------    1 root     root           283 Jan 23  2019 root
*/15    *       *       *       *       run-parts /etc/periodic/15min
0       *       *       *       *       run-parts /etc/periodic/hourly
0       2       *       *       *       run-parts /etc/periodic/daily
0       3       *       *       6       run-parts /etc/periodic/weekly
0       5       1       *       *       run-parts /etc/periodic/monthly

# do daily/weekly/monthly maintenance
# min   hour    day     month   weekday command
*/15    *       *       *       *       run-parts /etc/periodic/15min
0       *       *       *       *       run-parts /etc/periodic/hourly
0       2       *       *       *       run-parts /etc/periodic/daily
0       3       *       *       6       run-parts /etc/periodic/weekly
0       5       1       *       *       run-parts /etc/periodic/monthly


[+] Services
[i] Search for outdated versions
service|chkconfig|rc-status Not Found


===================================( Network Information )====================================
[+] Hostname, hosts and DNS
5a3d243127f5
127.0.0.1       localhost
::1     localhost ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
172.20.0.6      5a3d243127f5
search sata.nic
nameserver 127.0.0.11
options ndots:0

[+] Content of /etc/inetd.conf
/etc/inetd.conf Not Found

[+] Networks and neighbours
eth0      Link encap:Ethernet  HWaddr 02:42:AC:14:00:06
          inet addr:172.20.0.6  Bcast:172.20.255.255  Mask:255.255.0.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:4621 errors:0 dropped:0 overruns:0 frame:0
          TX packets:4229 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:1696640 (1.6 MiB)  TX bytes:7575266 (7.2 MiB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:69 errors:0 dropped:0 overruns:0 frame:0
          TX packets:69 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1
          RX bytes:4664 (4.5 KiB)  TX bytes:4664 (4.5 KiB)

172.20.0.1 dev eth0 lladdr 02:42:7e:d6:12:87 ref 1 used 0/0/0 probes 1 REACHABLE
172.20.0.4 dev eth0 lladdr 02:42:ac:14:00:04 used 0/0/0 probes 1 STALE
172.20.0.7 dev eth0 lladdr 02:42:ac:14:00:07 ref 1 used 0/0/0 probes 1 REACHABLE
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         172.20.0.1      0.0.0.0         UG    0      0        0 eth0
172.20.0.0      0.0.0.0         255.255.0.0     U     0      0        0 eth0

[+] Iptables rules
iptables rules Not Found

[+] Active Ports
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#internal-open-ports
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 127.0.0.11:46387        0.0.0.0:*               LISTEN      -
tcp        0      0 0.0.0.0:8888            0.0.0.0:*               LISTEN      1/python
tcp        0      0 172.20.0.6:8888         172.20.0.7:34192        TIME_WAIT   -
tcp        1      0 172.20.0.6:8888         172.20.0.7:39918        CLOSE_WAIT  1/python
tcp        0   9392 172.20.0.6:33197        10.10.14.93:4530        ESTABLISHED 79/sh
tcp        0      0 172.20.0.6:53740        172.20.0.4:3306         ESTABLISHED 1/python
tcp        0      0 172.20.0.6:44956        10.10.14.147:4444       ESTABLISHED 38/shell
tcp        1      0 172.20.0.6:8888         172.20.0.7:33134        CLOSE_WAIT  1/python
tcp        1      0 172.20.0.6:8888         172.20.0.7:55608        CLOSE_WAIT  1/python
tcp        0      0 172.20.0.6:8888         172.20.0.7:33168        TIME_WAIT   -
udp        0      0 127.0.0.11:55609        0.0.0.0:*                           -

[+] Can I sniff with tcpdump?
No


====================================( Users Information )=====================================
[+] My user
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#groups
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)

[+] Do I have PGP keys?
gpg Not Found

[+] Clipboard or highlighted text?
xsel and xclip Not Found

[+] Testing 'sudo -l' without password & /etc/sudoers
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#commands-with-sudo-and-suid-commands

[+] Checking /etc/doas.conf
/etc/doas.conf Not Found

[+] Checking Pkexec policy

[+] Don forget to test 'su' as any other user with shell: without password and with their names as password (I can't do it...)
[+] Do not forget to execute 'sudo -l' without password or with valid password (if you know it)!!

[+] Superusers
root:x:0:0:root:/root:/bin/ash

[+] Users with console
operator:x:11:0:operator:/root:/bin/sh
postgres:x:70:70::/var/lib/postgresql:/bin/sh
root:x:0:0:root:/root:/bin/ash

[+] Login information

[+] All users
adm
at
bin
cron
cyrus
daemon
ftp
games
guest
halt
lp
mail
man
news
nobody
ntp
operator
postgres
postmaster
root
shutdown
smmsp
squid
sshd
sync
uucp
vpopmail
xfs

[+] Password policy
/etc/login.defs Not Found


===================================( Software Information )===================================
[+] MySQL version
mysql Not Found

[+] MySQL connection using default root/root ........... No
[+] MySQL connection using root/toor ................... No
[+] MySQL connection using root/NOPASS ................. No
[+] Looking for mysql credentials and exec
 Not Found

[+] PostgreSQL version and pgadmin credentials
 Not Found

[+] PostgreSQL connection to template0 using postgres/NOPASS ........ No
[+] PostgreSQL connection to template1 using postgres/NOPASS ........ No
[+] PostgreSQL connection to template0 using pgsql/NOPASS ........... No
[+] PostgreSQL connection to template1 using pgsql/NOPASS ........... No

[+] Apache server info
 Not Found

[+] Looking for PHPCookies
 Not Found

[+] Looking for Wordpress wp-config.php files
wp-config.php Not Found

[+] Looking for Tomcat users file
tomcat-users.xml Not Found

[+] Mongo information
 Not Found

[+] Looking for supervisord configuration file
supervisord.conf Not Found

[+] Looking for cesi configuration file
cesi.conf Not Found

[+] Looking for Rsyncd config file
rsyncd.conf Not Found
[+] Looking for Hostapd config file
hostapd.conf Not Found

[+] Looking for wifi conns file
 Not Found

[+] Looking for Anaconda-ks config files
anaconda-ks.cfg Not Found

[+] Looking for .vnc directories and their passwd files
.vnc Not Found

[+] Looking for ldap directories and their hashes
.vnc Not Found

[+] Looking for .ovpn files and credentials
.ovpn Not Found

[+] Looking for ssl/ssh files
ls: /etc/ssh/ssh_config: No such file or directory

[+] Looking for unexpected auth lines in /etc/pam.d/sshd
No

[+] Looking for Cloud credentials (AWS, Azure, GC)

[+] NFS exports?
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe
/etc/exports Not Found

[+] Looking for kerberos conf files and tickets
[i] https://book.hacktricks.xyz/pentesting/pentesting-kerberos-88#pass-the-ticket-ptt
krb5.conf Not Found
tickets kerberos Not Found
klist Not Found

[+] Looking for Kibana yaml
kibana.yml Not Found

[+] Looking for logstash files
 Not Found

[+] Looking for elasticsearch files
 Not Found

[+] Looking for Vault-ssh files
vault-ssh-helper.hcl Not Found

[+] Looking for AD cached hahses
cached hashes Not Found

[+] Looking for screen sessions
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions
screen Not Found

[+] Looking for tmux sessions
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions
tmux Not Found

[+] Looking for Couchdb directory

[+] Looking for redis.conf

[+] Looking for dovecot files
dovecot credentials Not Found


====================================( Interesting Files )=====================================
[+] SUID
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#commands-with-sudo-and-suid-commands

[+] SGID
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#commands-with-sudo-and-suid-commands

[+] Capabilities
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities

[+] .sh files in path

[+] Files (scripts) in /etc/profile.d/
total 12
drwxr-xr-x    2 root     root          4096 Jan 30  2019 .
drwxr-xr-x    1 root     root          4096 Feb 10  2019 ..
-rw-r--r--    1 root     root           295 Jan 23  2019 color_prompt

[+] Hashes inside passwd file? ........... No
[+] Can I read shadow files? ........... root:::0:::::
bin:!::0:::::
daemon:!::0:::::
adm:!::0:::::
lp:!::0:::::
sync:!::0:::::
shutdown:!::0:::::
halt:!::0:::::
mail:!::0:::::
news:!::0:::::
uucp:!::0:::::
operator:!::0:::::
man:!::0:::::
postmaster:!::0:::::
cron:!::0:::::
ftp:!::0:::::
sshd:!::0:::::
at:!::0:::::
squid:!::0:::::
xfs:!::0:::::
games:!::0:::::
postgres:!::0:::::
cyrus:!::0:::::
vpopmail:!::0:::::
ntp:!::0:::::
smmsp:!::0:::::
guest:!::0:::::
nobody:!::0:::::
[+] Can I read root folder? ........... total 16
drwx------    1 root     root          4096 Dec 19 22:26 .
drwxr-xr-x    1 root     root          4096 Dec 19 22:37 ..
-rw-------    1 root     root           480 Dec 19 22:39 .ash_history
drwx------    1 root     root          4096 Feb  9  2019 .cache

[+] Looking for root files in home dirs (limit 20)
/home

[+] Files inside /home/root (limit 20)

[+] Files inside others home (limit 20)

[+] Looking for installed mail applications
ls: /usr/local/sbin: No such file or directory
sendmail

[+] Mails (limit 50)

[+] Backup files?

[+] Looking for tables inside readable .db/.sqlite files (limit 100)

[+] Web files?(output limit)

[+] *_history, .sudo_as_admin_successful, profile, bashrc, httpd.conf, .plan, .htpasswd, .git-credentials, .gitconfig, .rhosts, hosts.equiv, Dockerfile, docker-compose.yml
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#read-sensitive-data
-rw-------    1 root     root           480 Dec 19 22:39 /root/.ash_history
Looking for possible passwords inside /root/.ash_history


[+] All hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)

[+] Readable files inside /tmp, /var/tmp, /var/backups(limit 100)
-rw-r--r--    1 root     root         12356 Dec 19 22:39 /tmp/out
-rwxr-xr-x    1 root     root         46476 Dec 19 22:34 /tmp/LinEnum.sh
-rwxr-xr-x    1 root     root           207 Dec 19 22:16 /tmp/shell

[+] Searching passwords in config PHP files

[+] Finding IPs inside logs (limit 100)

[+] Finding passwords inside logs (limit 100)

[+] Finding emails inside logs (limit 100)

[+] Finding *password* or *credential* files in home

[+] Finding 'pwd' or 'passw' string inside /home, /var/www, /etc, /root and list possible web(/var/www) and config(/etc) passwords


