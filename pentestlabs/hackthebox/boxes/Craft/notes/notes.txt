api/brew/endpoints/brew.py line 43 has eval which should be vulnerable.

https://gogs.craft.htb/Craft/craft-api/commit/c414b160578943acfe2e158e89409623f41da4c6
https://gogs.craft.htb/Craft/craft-api/issues/2


See the dinesh credentials at:
https://gogs.craft.htb/Craft/craft-api/commit/10e3ba4f0a09c778d7cec673f28d410b73455a86#diff-0d54703daaa4591e1ffcee2211d24098714afa6R6

Also once on the docker container:

*****************************************************************
/opt/app # python db.py
{'id': 1, 'username': 'dinesh', 'password': '4aUh0A8PbVJxgd'}
*****************************************************************


Getting shell on the docker container
======================================

Simply exploit the eval() function in brew.py. Look at the vuln.sh file I created.

To get a root shell in the busybox instance (only a Docker/busybox instance)
- ./vuln.sh
- ./reverse_shell.sh in a separate window
- The above two will get you in
- python -c "import pty; pty.spawn(/bin/sh)"
- Ctrl-Z -> stty raw -echo -> fg    Now you have a good tty
- This is just a busybox instance inside a Docker container!

/ # whoami
root

/ # ifconfig
eth0      Link encap:Ethernet  HWaddr 02:42:AC:14:00:06
          inet addr:172.20.0.6  Bcast:172.20.255.255  Mask:255.255.0.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:5840 errors:0 dropped:0 overruns:0 frame:0
          TX packets:5341 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:2618237 (2.4 MiB)  TX bytes:9722281 (9.2 MiB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:80 errors:0 dropped:0 overruns:0 frame:0
          TX packets:80 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1
          RX bytes:4200 (4.1 KiB)  TX bytes:4200 (4.1 KiB)

- Run LinEnum.sh on the box - it has wget so we can download LinEnum.sh

Breaking out of a Docker container
----------------------------------

https://security.stackexchange.com/questions/152978/is-it-possible-to-escalate-privileges-and-escaping-from-a-docker-container

Goodies:
--------
- nc
- wget
- gcc
- sh
- ping
- python, python3.6

Is this a container? .......... Looks like we're in a Docker container

[+] Looks like we're in a Docker container:
10:pids:/docker/5a3d243127f5cfeb97bc6332eda2e4ceae19472421c0c5a7d226fb5fc1ef0f7c
9:cpu,cpuacct:/docker/5a3d243127f5cfeb97bc6332eda2e4ceae19472421c0c5a7d226fb5fc1ef0f7c
8:devices:/docker/5a3d243127f5cfeb97bc6332eda2e4ceae19472421c0c5a7d226fb5fc1ef0f7c
7:perf_event:/docker/5a3d243127f5cfeb97bc6332eda2e4ceae19472421c0c5a7d226fb5fc1ef0f7c
6:memory:/docker/5a3d243127f5cfeb97bc6332eda2e4ceae19472421c0c5a7d226fb5fc1ef0f7c
5:blkio:/docker/5a3d243127f5cfeb97bc6332eda2e4ceae19472421c0c5a7d226fb5fc1ef0f7c
4:freezer:/docker/5a3d243127f5cfeb97bc6332eda2e4ceae19472421c0c5a7d226fb5fc1ef0f7c
3:net_cls,net_prio:/docker/5a3d243127f5cfeb97bc6332eda2e4ceae19472421c0c5a7d226fb5fc1ef0f7c
2:cpuset:/docker/5a3d243127f5cfeb97bc6332eda2e4ceae19472421c0c5a7d226fb5fc1ef0f7c
1:name=systemd:/docker/5a3d243127f5cfeb97bc6332eda2e4ceae19472421c0c5a7d226fb5fc1ef0f7c
-rwxr-xr-x    1 root     root             0 Feb 10  2019 /.dockerenv


### Things to check
/etc/periodic
/dev/
###

Hostname: 5a3d243127f5


How to break out of Docker container?
-------------------------------------

https://security.stackexchange.com/questions/152978/is-it-possible-to-escalate-privileges-and-escaping-from-a-docker-container



