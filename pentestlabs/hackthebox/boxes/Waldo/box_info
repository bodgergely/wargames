=================================================================================================
LINUX PRIVILEGE ESCALATION CHECKER
=================================================================================================

[*] GETTING BASIC SYSTEM INFO...

[+] Kernel
    Linux version 4.9.0-6-amd64 (debian-kernel@lists.debian.org) (gcc version 6.3.0 20170516 (Debian 6.3.0-18+deb9u1) ) #1 SMP Debian 4.9.88-1 (2018-04-29)

[+] Hostname
    waldo

[+] Operating System
    Welcome to Alpine Linux 3.6
    Kernel \r on an \m (\l)

[*] GETTING NETWORKING INFO...

[+] Interfaces
    docker0   Link encap:Ethernet  HWaddr 02:42:08:0E:E7:24
    inet addr:172.17.0.1  Bcast:172.17.255.255  Mask:255.255.0.0
    UP BROADCAST MULTICAST  MTU:1500  Metric:1
    RX packets:0 errors:0 dropped:0 overruns:0 frame:0
    TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
    collisions:0 txqueuelen:0
    RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
    ens33     Link encap:Ethernet  HWaddr 00:50:56:B9:0E:7A
    inet addr:10.10.10.87  Bcast:10.10.10.255  Mask:255.255.255.0
    UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
    RX packets:848863 errors:0 dropped:31 overruns:0 frame:0
    TX packets:906688 errors:0 dropped:0 overruns:0 carrier:0
    collisions:0 txqueuelen:1000
    RX bytes:119992542 (114.4 MiB)  TX bytes:592347554 (564.9 MiB)
    lo        Link encap:Local Loopback
    inet addr:127.0.0.1  Mask:255.0.0.0
    UP LOOPBACK RUNNING  MTU:65536  Metric:1
    RX packets:699416 errors:0 dropped:0 overruns:0 frame:0
    TX packets:699416 errors:0 dropped:0 overruns:0 carrier:0
    collisions:0 txqueuelen:1
    RX bytes:95351214 (90.9 MiB)  TX bytes:95351214 (90.9 MiB)

[+] Netstat
    Active Internet connections (servers and established)
    Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
    tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -
    tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -
    tcp        0      0 0.0.0.0:8888            0.0.0.0:*               LISTEN      -
    tcp        0      0 127.0.0.1:9000          0.0.0.0:*               LISTEN      -
    tcp        0      0 127.0.0.1:22            127.0.0.1:34574         ESTABLISHED -
    tcp        0      0 10.10.10.87:8888        10.10.15.236:35412      ESTABLISHED -
    tcp        0     36 10.10.10.87:8888        10.10.15.236:42194      ESTABLISHED -
    tcp        0      0 10.10.10.87:8888        10.10.15.236:52736      ESTABLISHED -
    tcp        0      0 10.10.10.87:8888        10.10.14.43:35258       ESTABLISHED -
    tcp        0      0 10.10.10.87:8888        10.10.14.86:36118       ESTABLISHED -
    tcp        0      0 127.0.0.1:45902         127.0.1.1:22            ESTABLISHED 90/ssh
    tcp        0      0 127.0.1.1:22            127.0.0.1:45902         ESTABLISHED -
    tcp        0      0 10.10.10.87:8888        10.10.15.236:51690      ESTABLISHED -
    tcp        0      0 10.10.10.87:8888        10.10.15.236:43196      ESTABLISHED -
    tcp        0      0 127.0.0.1:34574         127.0.0.1:22            ESTABLISHED 2152/ssh
    tcp        0    226 10.10.10.87:80          10.10.12.6:55440        ESTABLISHED -
    tcp        0      0 10.10.10.87:8888        10.10.15.236:51268      ESTABLISHED -
    tcp        0      0 10.10.10.87:8888        10.10.15.236:54142      ESTABLISHED -
    tcp        0      0 :::80                   :::*                    LISTEN      -
    tcp        0      0 :::22                   :::*                    LISTEN      -
    tcp        0      0 :::8888                 :::*                    LISTEN      -
    udp        0      0 10.10.10.87:40170       10.10.10.2:53           ESTABLISHED -

[+] Route
    Kernel IP routing table
    Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
    default         10.10.10.2      0.0.0.0         UG    0      0        0 ens33
    10.10.10.0      *               255.255.255.0   U     0      0        0 ens33
    169.254.0.0     *               255.255.0.0     U     1000   0        0 ens33
    172.17.0.0      *               255.255.0.0     U     0      0        0 docker0

[*] GETTING FILESYSTEM INFO...

[+] Mount results

[+] fstab entries
    /dev/cdrom	/media/cdrom	iso9660	noauto,ro 0 0
    /dev/usbdisk	/media/usb	vfat	noauto,ro 0 0

[+] Scheduled cron jobs
    total 12
    drwxr-xr-x    2 root     root          4096 Jan  9  2018 .
    drwxr-xr-x    1 root     root          4096 May  3 20:50 ..
    -rw-------    1 root     root           283 Apr 24  2017 root

[+] Writable cron dirs


[*] ENUMERATING USER AND ENVIRONMENTAL INFO...

[+] Logged in User Activity

[+] Super Users Found:
    root

[+] Environment
    USER=nobody
    SSH_CLIENT=10.10.15.236 42194 8888
    MAIL=/var/mail/nobody
    SHLVL=2
    HOME=/home/nobody
    SSH_TTY=/dev/pts/2
    PAGER=less
    PS1=\h:\w\$
    LOGNAME=nobody
    TERM=screen-256color
    PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
    SHELL=/bin/sh
    PWD=/home/nobody
    SSH_CONNECTION=10.10.15.236 42194 10.10.10.87 8888
    CHARSET=UTF-8

[+] Root and current user history (depends on privs)
    lrwxrwxrwx    1 root     root             9 Jul 24 11:57 /home/nobody/.ash_history -> /dev/null

[+] Sudoers (privileged)

[+] All users
    root:x:0:0:root:/root:/bin/ash
    bin:x:1:1:bin:/bin:/sbin/nologin
    daemon:x:2:2:daemon:/sbin:/sbin/nologin
    adm:x:3:4:adm:/var/adm:/sbin/nologin
    lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
    sync:x:5:0:sync:/sbin:/bin/sync
    shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
    halt:x:7:0:halt:/sbin:/sbin/halt
    mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
    news:x:9:13:news:/usr/lib/news:/sbin/nologin
    uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin
    operator:x:11:0:operator:/root:/bin/sh
    man:x:13:15:man:/usr/man:/sbin/nologin
    postmaster:x:14:12:postmaster:/var/spool/mail:/sbin/nologin
    cron:x:16:16:cron:/var/spool/cron:/sbin/nologin
    ftp:x:21:21::/var/lib/ftp:/sbin/nologin
    sshd:x:22:22:sshd:/dev/null:/sbin/nologin
    at:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin
    squid:x:31:31:Squid:/var/cache/squid:/sbin/nologin
    xfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin
    games:x:35:35:games:/usr/games:/sbin/nologin
    postgres:x:70:70::/var/lib/postgresql:/bin/sh
    cyrus:x:85:12::/usr/cyrus:/sbin/nologin
    vpopmail:x:89:89::/var/vpopmail:/sbin/nologin
    ntp:x:123:123:NTP:/var/empty:/sbin/nologin
    smmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin
    guest:x:405:100:guest:/dev/null:/sbin/nologin
    nobody:x:65534:65534:nobody:/home/nobody:/bin/sh
    nginx:x:100:101:nginx:/var/lib/nginx:/sbin/nologin

[+] Current User
    nobody

[+] Current User ID
    uid=65534(nobody) gid=65534(nobody) groups=65534(nobody)

[*] ENUMERATING FILE AND DIRECTORY PERMISSIONS/CONTENTS...

[+] World Writeable Directories for User/Group 'Root'
    drwxrwxrwt    2 root     root            40 Sep 19 22:23 /dev/shm
    drwxrwxrwt    2 root     root            40 Sep 19 22:23 /dev/mqueue
    drwxrwxrwt    2 root     root            40 Sep 19 22:23 /sys/firmware
    drwxrwxrwt    1 root     root          4096 Sep 20 01:40 /tmp

[+] World Writeable Directories for Users other than Root

[+] World Writable Files
    --w--w--w-    1 root     root             0 Sep 19 22:23 /sys/fs/cgroup/memory/cgroup.event_control

[+] Checking if root's home folder is accessible
    /root:
    total 0

[+] SUID/SGID Files and Directories
    -rwsr-xr-x    1 root     root         41984 May 17  2017 /usr/bin/passwd
    -rwsr-xr-x    1 root     root         50016 May 17  2017 /usr/bin/chage
    -rwsr-xr-x    1 root     root         18536 May 17  2017 /usr/bin/expiry
    -rwsr-xr-x    1 root     root         41464 May 17  2017 /usr/bin/chfn
    -rwsr-xr-x    1 root     root         32256 May 17  2017 /usr/bin/chsh
    -rwsr-xr-x    1 root     root         31616 May 17  2017 /usr/bin/newgrp
    -rwsr-xr-x    1 root     root         54744 May 17  2017 /usr/bin/gpasswd
    -rwxr-sr-x    1 root     shadow       26328 May 16  2017 /sbin/unix_chkpwd

[+] Logs containing keyword 'password'

[+] Config files containing keyword 'password'

[+] Shadow File (Privileged)

[*] ENUMERATING PROCESSES AND APPLICATIONS...

[+] Installed Packages

[+] Current processes
    PID USER
    1 root
    7 root daemon off;
    8 root
    9 root
    10 nginx
    85 root
    87 nobody
    88 nobody
    90 nobody
    1284 root
    1286 nobody
    1287 nobody
    1296 root
    1298 nobody
    1299 nobody
    1680 root
    1682 nobody
    1683 nobody
    1692 nobody
    1717 root
    1719 nobody
    1720 nobody
    1721 nobody
    1728 root
    1731 nobody
    1732 nobody
    1733 nobody
    1761 root
    1763 nobody
    1764 nobody
    1765 nobody
    1774 root
    1781 nobody
    1782 nobody
    1783 nobody
    2129 root
    2131 nobody
    2132 nobody
    2152 nobody
    2794 nobody
    2795 nobody
    2890 nobody
    2972 nobody awk '{print $1,$2,$9,$10,$11}'
    2973 nobody
    2974 nobody

[+] Apache Version and Modules

[+] Apache Config File

[+] Sudo Version (Check out http://www.exploit-db.com/search/?action=search&filter_page=1&filter_description=sudo)

[*] IDENTIFYING PROCESSES AND PACKAGES RUNNING AS ROOT OR OTHER SUPERUSER...

    2129 root   
    7 root daemon off; 
    1717 root   
    1774 root   
    9 root   
    8 root   
    1728 root   
    85 root   
    1296 root   
    1761 root   
    1 root   
    1284 root   
    1680 root   

[*] ENUMERATING INSTALLED LANGUAGES/TOOLS FOR SPLOIT BUILDING...

[+] Installed Tools
    /usr/bin/awk
    /usr/bin/python
    /usr/bin/vi
    /usr/bin/vim
    /usr/bin/find
    /usr/bin/nc
    /usr/bin/wget
    /usr/bin/tftp

[+] Related Shell Escape Sequences...

    vi-->	:!bash
    vi-->	:set shell=/bin/bash:shell
    vi-->	:!bash
    vi-->	:set shell=/bin/bash:shell
    awk-->	awk 'BEGIN {system("/bin/bash")}'
    find-->	find / -exec /usr/bin/awk 'BEGIN {system("/bin/bash")}' \;

[*] FINDING RELEVENT PRIVILEGE ESCALATION EXPLOITS...

    Note: Exploits relying on a compile/scripting language not detected on this system are marked with a '**' but should still be tested!

    The following exploits are ranked higher in probability of success because this script detected a related running process, OS, or mounted file system
    - Debian OpenSSL Predictable PRNG Bruteforce SSH Exploit || http://www.exploit-db.com/exploits/5720 || Language=python
    - Ubuntu/Debian Apache 1.3.33/1.3.34 (CGI TTY) Local Root Exploit || http://www.exploit-db.com/exploits/3384 || Language=c

    The following exploits are applicable to this kernel version and should be investigated as well
    - Kernel ia32syscall Emulation Privilege Escalation || http://www.exploit-db.com/exploits/15023 || Language=c
    - Sendpage Local Privilege Escalation || http://www.exploit-db.com/exploits/19933 || Language=ruby**
    - CAP_SYS_ADMIN to Root Exploit 2 (32 and 64-bit) || http://www.exploit-db.com/exploits/15944 || Language=c
    - CAP_SYS_ADMIN to root Exploit || http://www.exploit-db.com/exploits/15916 || Language=c
    - MySQL 4.x/5.0 User-Defined Function Local Privilege Escalation Exploit || http://www.exploit-db.com/exploits/1518 || Language=c
    - open-time Capability file_ns_capable() Privilege Escalation || http://www.exploit-db.com/exploits/25450 || Language=c
    - open-time Capability file_ns_capable() - Privilege Escalation Vulnerability || http://www.exploit-db.com/exploits/25307 || Language=c

